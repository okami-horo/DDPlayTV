# media-library-config-auto-apply Specification

## Purpose

在“媒体库配置/编辑存储源”界面中，用户修改配置后无需点击“确定”即可保存并生效；界面不再提供“确定/取消”按钮，改为通过返回键/手势返回/关闭弹窗退出。

## ADDED Requirements

### Requirement: 配置修改无需确认即可生效

系统 SHALL 在媒体库配置界面中对配置变更执行自动持久化，使其在用户离开界面后立即生效，且不需要额外点击“确定”。

#### Scenario: 编辑存储源后直接返回仍保留修改

- **WHEN** 用户打开任一存储源的“编辑配置”弹窗并修改任意字段（例如显示名称、地址、模式开关）
- **AND** 用户通过返回键/手势返回/下滑关闭弹窗离开界面
- **THEN** 系统已持久化该修改
- **AND** 用户再次进入该存储源配置界面时应展示修改后的值

### Requirement: 移除“确定/取消”按钮

系统 SHALL 在媒体库配置界面中移除底部“确定/取消”按钮，不依赖其完成保存或退出。

#### Scenario: 配置弹窗不再展示确定/取消

- **WHEN** 用户打开任一存储源配置弹窗
- **THEN** 弹窗底部不展示“确定/取消”按钮
- **AND** 用户可通过返回键/关闭弹窗完成退出

### Requirement: 新增存储源不产生半成品记录

系统 SHALL 避免在新增存储源流程中创建不完整/不可用的媒体库记录；仅当配置满足最小校验且必要的鉴权/校验动作已完成时，才写入媒体库记录。

#### Scenario: 未完成输入直接退出不创建媒体库

- **WHEN** 用户进入“新增存储源”配置弹窗
- **AND** 用户未完成必要字段输入/未完成必要鉴权即退出
- **THEN** 系统不创建新的媒体库记录

### Requirement: 需要显式动作的流程在成功后自动生效

系统 SHALL 对需要显式动作的流程（例如扫码登录、测试连接、投屏连接）在动作成功后自动完成持久化与生效，而非依赖额外“确定”按钮。

#### Scenario: 登录/测试/连接成功后无需再点确定

- **WHEN** 用户在存储源配置中执行“登录/授权/测试连接/连接设备”等动作
- **AND** 该动作成功
- **THEN** 系统自动完成配置持久化并生效
